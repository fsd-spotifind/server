generator db {
    provider = "go run github.com/steebchen/prisma-client-go"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id         String   @id @default(cuid())
    username   String   @unique
    isVerified Boolean  @default(false) @map("is_verified")
    email      String   @unique
    bio        String?
    photoUrl   String?  @map("photo_url")
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt

    friendsInitiated Friends[]      @relation("UserOne")
    friendsReceived  Friends[]      @relation("UserTwo")
    Track            SongOfTheDay[]

    @@map("users")
}

model Friends {
    id        String       @id @default(cuid())
    status    FriendStatus
    userOneId String       @map("user_one_id")
    userTwoId String       @map("user_second_id")
    createdAt DateTime     @default(now())
    updatedAt DateTime     @updatedAt

    userOne User @relation("UserOne", fields: [userOneId], references: [id])
    userTwo User @relation("UserTwo", fields: [userTwoId], references: [id])

    @@map("friends")
}

model SongOfTheDay {
    id        String   @id @default(cuid())
    userId    String   @map("user_id")
    trackId   String   @unique
    setAt     DateTime @default(now())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    user User @relation(fields: [userId], references: [id])

    @@map("song_of_the_day")
}

enum FriendStatus {
    ACTIVE  @map("active")
    BLOCKED @map("blocked")
    REMOVED @map("removed")
}
